#!/usr/bin/env modbuild

# Binary distribution with manual installation. See README.md

pbuild::post_prep() {
    cp "$BUILDBLOCK_DIR/ctffind_wrapper.sh" "$BUILD_DIR/ctffind_wrapper"
    sed -i "s|@CTFFINDPATH@|$PREFIX/bin/ctffind.orig|" "$BUILD_DIR/ctffind_wrapper"
}

pbuild::install() {
    mkdir -p "$PREFIX/bin"
    mv "$SRC_DIR/"* "$PREFIX/bin"

    # swap the binary with the wrapper
    mv "$PREFIX/bin/ctffind" "$PREFIX/bin/ctffind.orig"
    mv "$BUILD_DIR/ctffind_wrapper" "$PREFIX/bin/ctffind"
}

