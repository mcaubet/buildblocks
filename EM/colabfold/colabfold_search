#!/bin/bash

# Validate that the ColabFold image is specified and exists
if [[ -z "${APPTAINER_IMAGE:-}" || ! -f "$APPTAINER_IMAGE" ]]; then
    echo "Error: ColabFold image not found or is not set."
    echo "Please contact the system administrators for assistance."
    exit 1
fi

IMAGE="$APPTAINER_IMAGE"

# Run ColabFold search inside the Singularity container
singularity exec --nv \
    --bind "/data/scratch/shared:/data/scratch/shared" \
    --bind "/data/user:/data/user" \
    --bind "/data/project:/data/project" \
    --bind "/scratch:/scratch" \
    --bind "/tmp:/tmp" \
    --bind "/etc/ssl/ca-bundle.pem:/etc/ssl/ca-bundle.pem" \
    "$IMAGE" \
    colabfold_search "$@"
