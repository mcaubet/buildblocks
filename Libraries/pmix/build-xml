#!/usr/bin/env modbuild

pbuild::pre_configure() {
  if [[ -v HWLOC_PREFIX ]]; then
    pbuild::add_configure_args "--with-hwloc=${HWLOC_PREFIX}"
  fi

  if [[ -v LIBEVENT_PREFIX ]]; then
    pbuild::add_configure_args "--with-libevent=${LIBEVENT_PREFIX}"
  fi

  if [[ -v INTEL_VERSION ]]; then
          pbuild::add_configure_args "CC=icc"
          pbuild::add_configure_args "CXX=icpc"
          pbuild::add_configure_args "FC=ifort"
          pbuild::add_configure_args "F77=ifort"
          pbuild::add_configure_args "F90=ifort"
          # pbuild::add_configure_args "LDFLAGS=-Wc,-static-intel"
  fi

  # pbuild::add_configure_args "--enable-pmi-backward-compatibility"
  pbuild::add_configure_args "--enable-shared"
  pbuild::add_configure_args "--enable-static"
}
